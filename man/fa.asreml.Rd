% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/FA_asreml_toolkit.r
\name{fa.asreml}
\alias{fa.asreml}
\title{Extract and Rotate Factor Analytic Model Parameters}
\usage{
fa.asreml(model, classify, rotate = TRUE)
}
\arguments{
\item{model}{A fitted object of class \code{asreml}.}

\item{classify}{A character string defining the random model term. Must match the
ASReml syntax used in the model call. Supports both standard terms
(e.g., \code{"fa(Site, 2):Genotype"}) and genomic terms
(e.g., \code{"fa(Site, 2):vm(Genotype, grm)"}).}

\item{rotate}{Logical. If \code{TRUE} (default), loadings and scores are rotated
to the Principal Component solution. This is required for valid interpretation
of Overall Performance (OP) and Stability (RMSD).}
}
\value{
An object of class \code{fa_asreml} containing:
\describe{
  \item{loadings}{List of \code{raw} and \code{rotated} site loadings.}
  \item{scores}{List of \code{raw} and \code{rotated} genotype scores (BLUPs).}
  \item{var_comp}{Specific variances (\code{psi}) and Variance Accounted For (\code{vaf}).}
  \item{matrices}{Estimated Genetic Covariance (\code{G}) and Correlation (\code{Cor}) matrices.}
  \item{fast}{Dataframe of FAST indices: Overall Performance (OP) and Stability (RMSD).}
}
}
\description{
The primary engine of the toolkit. Parses an ASReml-R model object to extract
loadings, scores, and specific variances from a Factor Analytic (FA) term.
It performs Singular Value Decomposition (SVD) rotation to align the solution
with the Principal Component axis, enabling the calculation of Smith & Cullis (2018)
FAST indices.
}
\references{
Smith, A. B., & Cullis, B. R. (2018). Plant breeding selection tools built on
factor analytic mixed models for multi-environment trial data. \emph{Euphytica}, 214(8).
}
