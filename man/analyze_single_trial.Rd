% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/single_trial_analysis.R
\name{analyze_single_trial}
\alias{analyze_single_trial}
\title{Analyze Single Variate Single Trial}
\usage{
analyze_single_trial(
  data,
  traits,
  study_col = "studyName",
  genotype_col = "germplasmName",
  row_col = "rowNumber",
  col_col = "colNumber",
  rep_col = "replicate",
  block_col = "blockNumber",
  spatial_models = list(Independent = "~id(col_f):id(row_f)", AR1xAR1 =
    "~ar1(col_f):ar1(row_f)"),
  plot_residuals = FALSE
)
}
\arguments{
\item{data}{A data frame containing the trial data.}

\item{traits}{A character vector of trait column names to analyze.}

\item{study_col}{Character. Column name for the study/environment identifier.}

\item{genotype_col}{Character. Column name for the genotype identifier.}

\item{row_col}{Character. Column name for the row coordinate.}

\item{col_col}{Character. Column name for the column coordinate.}

\item{rep_col}{Character. Column name for the replicate identifier.}

\item{block_col}{Character. Column name for the block identifier.}

\item{spatial_models}{A named list of residual formulas to test. Default tests independent and AR1xAR1 errors.}

\item{plot_residuals}{Logical. Whether to generate residual plots (currently returned as data/objects, not saved to disk).}
}
\value{
A list containing:
\item{blues}{Data frame of Best Linear Unbiased Estimators with columns: genotype, trait, study, predicted.value, std.error, reliability.}
\item{model_stats}{Data frame of model statistics including BIC, selected spatial model, and convergence status.}
\item{correlations}{Phenotypic correlation matrix of BLUEs (if applicable).}
}
\description{
Performs single trial analysis for multiple traits across multiple studies/environments.
Automates data cleaning, spatial grid completion, spatial model selection (BIC),
and extraction of BLUEs and heritability metrics.
}
