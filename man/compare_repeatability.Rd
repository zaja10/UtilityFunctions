% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compare_repeatability.r
\name{compare_repeatability}
\alias{compare_repeatability}
\title{Compare Site-Specific Repeatability Metrics}
\usage{
compare_repeatability(model, fa_object)
}
\arguments{
\item{model}{A fitted \code{asreml} object.}

\item{fa_object}{An object of class \code{fa_asreml} produced by \code{fa.asreml()}.}
}
\value{
A data.frame summarizing Repeatability, Genetic Variance (Vg), and Residual Variance (Ve = NA) per Site.
}
\description{
Calculates the Model-Based Reliability ($R$) for each environment in the trial.
Unlike simple repeatability based on variance components, this function uses
the **Prediction Error Variance (PEV)** from the BLUPs to provide a rigorous
quality metric that accounts for experimental design imbalance and explicit
specific variances ($\Psi$) in Factor Analytic or Reduced Rank models.

Metric: \deqn{R = 1 - \frac{\text{PEV}_{avg}}{V_g}}
}
\details{
This function performs a split-prediction strategy to compute the average PEV
for each site efficiently. It automatically cleans the \code{classify} term
(e.g., transforming \code{rr(Site,2):Gen} to \code{Site:Gen}) to ensure that
\code{predict()} captures the Total Genetic Effect (Factor + Specific/Diag).
}
