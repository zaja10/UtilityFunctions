% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_h2_from_list.r
\name{calculate_h2_from_list}
\alias{calculate_h2_from_list}
\title{Calculate Heritability from a List of ASReml Models}
\usage{
calculate_h2_from_list(model_list, id = "Genotype")
}
\arguments{
\item{model_list}{A named list containing fitted `asreml` objects.}

\item{id}{A character string specifying the name of the factor representing
the genetic random effect (e.g., "Genotype", "Variety"). Defaults to "Genotype".}
}
\value{
A named list or vector containing the calculated heritability (H2)
  for each valid and converged model in the input list. Returns NA for
  models that are invalid, did not converge, or encountered errors during
  calculation.
}
\description{
This function iterates through a list of fitted asreml model objects and
calculates broad-sense heritability (H2) based on the Cullis method
(1 - mean(PEV) / Vg), using the variance-covariance matrix of predictions.
Note: This function uses `predict(..., vcov = TRUE)` and may fail with a
"long vector not supported" error if the genetic factor has many levels,
leading to a very large prediction variance-covariance matrix. A safer
alternative uses standard errors from predict.
}
\examples{
\dontrun{
# Assuming 'fm' is a list like fm <- list(fm0=model0, fm1=model1, ...)
heritabilities <- calculate_h2_from_list(fm, id = "Variety")
print(heritabilities)
}
}
