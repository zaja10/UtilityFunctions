% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/metrics.R
\name{calculate_heritability}
\alias{calculate_heritability}
\title{Calculate Heritability and Reliability}
\usage{
calculate_heritability(
  model,
  method = "Cullis",
  id_var = "Genotype",
  vcov = NULL
)
}
\arguments{
\item{model}{A fitted \code{asreml} object or a list of such objects.}

\item{method}{Character string. "Cullis" (default) or "Standard".}

\item{id_var}{Character string. Name of the genetic factor (default "Genotype").}

\item{vcov}{Logical. If TRUE, forces usage of the variance-covariance matrix (required for Standard).
For large number of genotypes (>2000), defaults to FALSE to avoid memory exhaustion unless explicitly set.}
}
\value{
A named vector of heritability values.
}
\description{
Computes broad-sense heritability metrics from ASReml models.
Supports both "Cullis" (Generalized Heritability) and "Standard" (Line Mean Reliability) methods.
}
\details{
\strong{Methods:}
\itemize{
  \item \strong{Cullis:} \eqn{1 - \frac{\bar{v}_{\Delta}^{BLUP}}{2 \sigma^2_g}}. Based on the average standard error of difference (SED). Recommended for unbalanced trials.
  \item \strong{Standard:} \eqn{1 - \frac{PEV}{\sigma^2_g}}. Based on the prediction error variance.
}
}
